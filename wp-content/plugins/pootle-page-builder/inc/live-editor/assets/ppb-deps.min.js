(function($){if("function"!=typeof panels.addInputFieldEventHandlers)panels.addInputFieldEventHandlers=function($this){$("html").trigger("pootlepb_admin_input_field_event_handlers",[$this]);$this.find('input[data-style-field="accordion"]').off("change").on("change",function(){if($(this).prop("checked"))$this.find(".accordion_section").slideDown();else $this.find(".accordion_section").slideUp()});(function(){var canvas=$this.find(".bg-grad-prevu")[0];if(canvas&&canvas.getContext){var grd,col1,col2,type,ctx=canvas.getContext("2d");$this.find("#row_grad_preset").off("change").on("change",function(){var colors=$(this).val().split(",");$('input[data-style-field="grad_col1"]').val(colors[0]).change();$('input[data-style-field="grad_col2"]').val(colors[1]).change()});$this.find('input[data-style-field*="grad_col"], select[data-style-field="grad_type"]').off("change").on("change",function(){col1=$('input[data-style-field="grad_col1"]').val();col2=$('input[data-style-field="grad_col2"]').val();type=$('select[data-style-field="grad_type"]').val();if(!col1||!col2){canvas.style.display="none";return}canvas.style.display="block";if(!type){grd=ctx.createLinearGradient(0,0,0,160)}else if("radial"==type){grd=ctx.createRadialGradient(125,80,0,125,80,160)}else{grd=ctx.createLinearGradient(0,0,250,160)}grd.addColorStop(0,col1?col1:"#fff");grd.addColorStop(1,col2?col2:"#ccc");ctx.fillStyle=grd;ctx.fillRect(0,0,250,160)}).change()}})();$this.find('input[data-style-field-type="color"]').each(function(){$t=$(this);var wpPkrContnr=$t.closest(".wp-picker-container");if(wpPkrContnr.length==0){$t.wpColorPicker({change:function(e,ui){$(this).change()}})}});$this.find(".upload-button, .unsplash-button, .video-upload-button").off("click");var ppbFileFrame,ppbMP4VideoFrame;$this.find(".upload-button").on("click",function(event){event.preventDefault();var $textField=$(this).siblings('input[data-style-field-type="upload"]');if(ppbFileFrame){ppbFileFrame.open();return}ppbFileFrame=wp.media.frames.ppbFileFrame=wp.media({title:"Choose Background Image",button:{text:"Set As Background Image"},multiple:false});ppbFileFrame.on("select",function(){attachment=ppbFileFrame.state().get("selection").first().toJSON();$textField.val(attachment.url).change()});ppbFileFrame.open()});$this.find('input[data-style-field-type="upload"] ~ .search-unsplash-wrap').attr("style","");$this.find('input[data-style-field-type="upload"]').off("change").change(function(){var $t=$(this);if($t.val()){var url=$t.val();if(url=="post-image"){url=$("[data-featured-img-url]").data("featured-img-url")}$t.show().css("background-image",'url("'+url+'")').siblings(".dashicons").show()}else{$t.hide().siblings(".dashicons").hide()}});$this.find(".post-image-button").on("click",function(e){var $textField=$(this).closest(".field_type-upload, .field_type_upload").find('input[data-style-field-type="upload"]');$textField.val("post-image").change()});$this.find(".unsplash-button").on("click",function(e){e.preventDefault();var $t=$(this),$searchField=$t.siblings('input[type="search"]'),$textField=$t.closest(".field_type-upload, .field_type_upload").find('input[data-style-field-type="upload"]');if(!$searchField.is(":visible")){$searchField.show();return}ShrameeUnsplashImage(function(url){$textField.val(url).change();$searchField.val("")},$searchField.val())});$this.find(".video-upload-button").on("click",function(event){event.preventDefault();var $textField=$(this).siblings("input");if(ppbMP4VideoFrame){ppbMP4VideoFrame.open();return}ppbMP4VideoFrame=wp.media.frames.ppbMP4VideoFrame=wp.media({title:"Choose MP4/WEBM Background Video File",library:{type:"video"},button:{text:"Set As Background Video"},multiple:false});ppbMP4VideoFrame.on("select",function(){attachment=ppbMP4VideoFrame.state().get("selection").first().toJSON();$textField.val(attachment.url);$textField.change()});ppbMP4VideoFrame.open()});slider_val_update=function(valu,$t,$f,$spn){var max=$t.data("max");$f.val(valu).change();if($t.data("show-actual-val")){$spn.text(valu+$t.data("unit"))}else{$spn.text(Math.round(valu/max*100)+"%")}};$this.find(".ppb-slider").each(function(){var $t=$(this),$f=$t.siblings("input"),$spn=$(this).siblings(".slider-val"),max=$t.data("max"),valu;if(""!=$f.val()){valu=$f.val()}else{valu=$t.data("default")}slider_val_update(valu,$t,$f,$spn);$t.slider({min:$t.data("min"),max:max,step:$t.data("step"),value:valu,slide:function(e,ui){slider_val_update(ui.value,$t,$f,$spn)},change:function(e,ui){slider_val_update(ui.value,$t,$f,$spn)}})});$this.find(".ppb-chzn-multi").each(function(){var $t=$(this);$t.chosen({width:"250px",placeholder_text_multiple:$t.attr("placeholder")})})};if("function"!=typeof panels.bgVideoMobImgSet)panels.bgVideoMobImgSet=function(){$("#row-bg-video-notice").remove();$("#pp-pb-bg_mobile_image").attr("style","");if(".bg_video"==$("#pp-pb-background_toggle").val()&&$("#pp-pb-bg_video").val()){if(""==$("#pp-pb-bg_mobile_image").val().replace(" ","")){var notice=$("<div/>").attr("id","row-bg-video-notice").addClass("ppb-alert").html('<span class="dashicons dashicons-no"></span>Please select an image to display instead of the background video for mobile devices.');$(".bg_section.bg_video").append(notice);$("#pp-pb-bg_mobile_image").css({backgroundColor:"#fcc",borderColor:"#f88"});return false}}return true};panels.getStylesFromFields=function($styleForm,styleData){styleData=styleData?styleData:{};$styleForm.find("[dialog-field]").each(function(){var $t=$(this),key=$t.attr("dialog-field"),type=$t.attr("type");if(type=="checkbox"){styleData[key]="";if($t.prop("checked")){styleData[key]=$t.val()}}else if(type=="radio"){if($t.prop("checked")){styleData[key]=$t.val()}}else{styleData[key]=$t.val()}});return styleData};if("function"!=typeof panels.setStylesToFields)panels.setStylesToFields=function($styleForm,styleData){$styleForm.find("input[type=checkbox]").prop("checked",false).change();$styleForm.find("input[type=text], input[type=hidden], select, input[type=number], textarea").val("").change().trigger("chosen:updated");$styleForm.find(':radio[value=""]').prop("checked",true).change();for(var key in styleData){if(styleData.hasOwnProperty(key)){var $field=$styleForm.find('[dialog-field="'+key+'"]');if($field.attr("data-style-field-type")=="color"){$field.wpColorPicker("color",styleData[key])}else if($field.attr("data-style-field-type")=="slider"){$field.siblings(".ppb-slider").slider("value",styleData[key])}else if($field.attr("data-style-field-type")=="radio"){$field.filter('[value="'+styleData[key]+'"]').prop("checked",true)}else if($field.attr("data-style-field-type")=="checkbox"){if(styleData[key]==$field.val()){$field.prop("checked",true)}else{$field.prop("checked",false)}}else{$field.val(styleData[key])}$field.change().trigger("chosen:updated")}}}})(jQuery);